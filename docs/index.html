<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Geo Anomaly Mapper</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-sA+e2atTH7ZS6VkJcgkPC2A5Y3VtN3hKpQt3bSX0hCg="
      crossorigin=""
    />
    <link rel="stylesheet" href="css/styles.css" />
    <meta
      name="description"
      content="Interactive viewer for subsurface void detections produced by the Geo Anomaly Mapper processing pipeline."
    />
  </head>
  <body>
    <header class="hero">
      <div class="hero__overlay"></div>
      <div class="hero__content">
        <h1>Geo Anomaly Mapper</h1>
        <p>
          Explore processed anomaly detections, visualize potential voids, and
          share insights with collaborators.
        </p>
        <div class="hero__actions">
          <a class="btn btn--primary" href="#map">View detections</a>
          <a class="btn" href="#how-to-update">How to update data</a>
        </div>
      </div>
    </header>

    <main>
      <section class="section" id="overview">
        <div class="section__header">
          <h2>Project at a glance</h2>
          <p>
            The viewer automatically surfaces key metrics from the exported
            GeoJSON data so teammates can quickly assess the latest findings.
          </p>
        </div>
        <div class="stats" id="stats">
          <article class="stat">
            <h3>Total voids</h3>
            <p class="stat__value" id="stat-total">—</p>
          </article>
          <article class="stat">
            <h3>Average confidence</h3>
            <p class="stat__value" id="stat-confidence">—</p>
          </article>
          <article class="stat">
            <h3>Newest dataset</h3>
            <p class="stat__value" id="stat-dataset">—</p>
          </article>
        </div>
      </section>

      <section class="section" id="map">
        <div class="section__header">
          <h2>Interactive map</h2>
          <p>
            Click on any marker to reveal metadata about the detected void,
            including confidence, estimated size, and source dataset.
          </p>
        </div>
        <div class="map-layout">
          <div id="map-view"></div>
          <aside class="sidebar">
            <div class="sidebar__header">
              <h3>Detections</h3>
              <div class="sidebar__filters">
                <label class="filter">
                  <span>Confidence &ge;</span>
                  <input
                    type="range"
                    min="0"
                    max="1"
                    step="0.05"
                    value="0"
                    id="confidence-filter"
                  />
                  <span id="confidence-label">0.00</span>
                </label>
                <label class="filter">
                  <input type="checkbox" id="show-heatmap" />
                  <span>Heatmap overlay</span>
                </label>
              </div>
            </div>
            <ul class="detection-list" id="detection-list"></ul>
          </aside>
        </div>
      </section>

      <section class="section" id="how-to-update">
        <div class="section__header">
          <h2>Updating the site with new results</h2>
          <p>
            Preparing a release only requires exporting a GeoJSON file from the
            processing pipeline and committing it alongside this website.
          </p>
        </div>
        <ol class="steps">
          <li>
            <strong>Generate the GeoJSON export.</strong> Use the provided
            Python scripts to produce a consolidated
            <code>voids.geojson</code> file that contains one feature per
            detected void. Each feature should include the fields documented in
            <a href="#expected-schema">the schema section</a>.
          </li>
          <li>
            <strong>Copy the file into <code>docs/data/voids.geojson</code>.</strong>
            Commit the change and push it to the repository. GitHub Pages will
            automatically redeploy the site.
          </li>
          <li>
            <strong>Optionally add supporting material.</strong> You can include
            additional layers (e.g., raster imagery or cross-sections) in the
            <code>docs/data</code> folder and update
            <code>docs/js/app.js</code> to surface them in the interface.
          </li>
        </ol>
      </section>

      <section class="section" id="expected-schema">
        <div class="section__header">
          <h2>Expected data schema</h2>
          <p>
            The viewer uses a GeoJSON FeatureCollection with the following
            properties per feature. Custom fields are preserved and displayed in
            the details panel.
          </p>
        </div>
        <div class="schema">
          <table>
            <thead>
              <tr>
                <th>Property</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>id</code></td>
                <td>Unique identifier for the void detection.</td>
              </tr>
              <tr>
                <td><code>name</code></td>
                <td>Human readable label (optional).</td>
              </tr>
              <tr>
                <td><code>confidence</code></td>
                <td>Confidence score between 0 and 1.</td>
              </tr>
              <tr>
                <td><code>depth_m</code></td>
                <td>Estimated depth in meters.</td>
              </tr>
              <tr>
                <td><code>radius_m</code></td>
                <td>Estimated radius or characteristic size in meters.</td>
              </tr>
              <tr>
                <td><code>dataset</code></td>
                <td>Source dataset or acquisition campaign.</td>
              </tr>
              <tr>
                <td><code>notes</code></td>
                <td>Free-form commentary, quality remarks, or context.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>
        &copy; <span id="year"></span> Geo Anomaly Mapper. Built for collaborative
        subsurface anomaly investigations.
      </p>
      <p>
        Questions or contributions? Open an issue on
        <a href="https://github.com/" target="_blank" rel="noopener"
          >GitHub</a
        >.
      </p>
    </footer>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-o9N1j7kGSt2L1rA96dG38p2wkEkgj7Sk6ZfD1Vogj1w="
      crossorigin=""
    ></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
    <script type="module" src="js/app.js"></script>
  </body>
</html>
